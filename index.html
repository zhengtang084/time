<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- === SEO ä¼˜åŒ–ï¼ˆæå‡æœç´¢å¼•æ“æ”¶å½•ä¸ç¤¾äº¤åˆ†äº«æ•ˆæœï¼‰=== -->
    <title>åšè°ˆå½±åƒæ¡£æ¡ˆåº“ ChinaTime - å†å²å½±åƒæ—¶é—´æœºå™¨</title>
    <meta name="description" content="åšè°ˆç½‘å†å²å½±åƒæ¡£æ¡ˆåº“ï¼Œæ”¶å½•2014å¹´ä»¥æ¥å¾®åšè°ˆã€å¾®å†å²ã€å¾®è§†é‡ç­‰æ ç›®ç»å…¸å›¾ç‰‡ï¼Œæ”¯æŒæ—¶é—´è½´ã€æ–‡å­—æœç´¢ã€å¤šè¯­è¨€æµè§ˆï¼Œéå•†ä¸šå­¦æœ¯ç ”ç©¶ä¸“ç”¨ã€‚">
    <meta name="keywords" content="åšè°ˆç½‘,å†å²å½±åƒ,å¾®åšè°ˆ,å¾®å†å²,å¾®è§†é‡,ä¸­å›½æ¡£æ¡ˆ,äº’è”ç½‘å†å²,å›¾ç‰‡åº“,åšè°ˆå½±åƒæ¡£æ¡ˆåº“,äº’è”ç½‘å†å²å½±åƒåº“">
   
    <!-- Open Graphï¼ˆå¾®ä¿¡ã€Twitterã€Facebook ç­‰åˆ†äº«æ—¶æ˜¾ç¤ºæ¼‚äº®å¡ç‰‡ï¼‰ -->
    <meta property="og:title" content="åšè°ˆå½±åƒæ¡£æ¡ˆåº“ ChinaTime - å†å²å½±åƒæ—¶é—´æœºå™¨">
    <meta property="og:description" content="æµ·é‡åšè°ˆç½‘å†å²å½±åƒï¼Œæ”¯æŒæ—¶é—´è½´ç­›é€‰ã€å…³é”®è¯æœç´¢ã€å¤šè¯­è¨€åˆ‡æ¢ã€‚">
    <meta property="og:image" content="https://yourdomain.com/preview.jpg"> <!-- è¯·æ›¿æ¢ä¸ºä½ çš„é¢„è§ˆå›¾é“¾æ¥ -->
    <meta property="og:url" content="https://yourdomain.com/">
    <meta property="og:type" content="website">
    
    <!-- å¼ºåˆ¶ HTTPSï¼ˆæå‡å®‰å…¨ï¼‰ -->
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #0066cc;
            --main-bg: #f8f9fa;
            --card-bg: #ffffff;
            --text-main: #333333;
            --text-muted: #666666;
            --border-color: #e0e0e0;
            --input-bg: #ffffff;
            --control-bg: #f1f3f5;
            --thumb-color: #0066cc;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --primary-color: #4d88ff;
                --main-bg: #1e1e1e;
                --card-bg: #2d2d2d;
                --text-main: #e0e0e0;
                --text-muted: #aaaaaa;
                --border-color: #444444;
                --input-bg: #333333;
                --control-bg: #3a3a3a;
                --thumb-color: #4d88ff;
            }
        }

        html, body {
            overflow-x: hidden;
            width: 100%;
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body { 
            font-family: "Segoe UI", system-ui, -apple-system, "Microsoft YaHei", "PingFang SC", sans-serif; 
            background-color: var(--main-bg); 
            color: var(--text-main); 
            min-width: 0;
            transition: all 0.3s ease;
        }

        #mobile-menu-btn {
            display: none;
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 200;
            background: var(--primary-color);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        #sidebar-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 300px;
            height: 100vh;
            background: var(--main-bg);
            border-right: 1px solid var(--border-color);
            z-index: 100;
            transition: transform 0.3s ease;
        }

        #sidebar {
            width: 300px;
            padding: 25px;
            box-sizing: border-box;
            overflow-y: auto;
            height: 100%;
        }

        .sidebar-item { margin-bottom: 25px; }
        .label-text { font-size: 13px; color: #888; margin-bottom: 8px; display: block;}
        .label-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; }
        
        .range-sub-info { display: flex; justify-content: space-between; font-size: 11px; color: var(--text-main); margin-top: 4px; opacity: 0.8; }
        
        .stats-box { background: var(--control-bg); padding: 15px; border-radius: 10px; text-align: center; margin-bottom: 25px; border: 1px solid var(--border-color); }
        #total-count { font-size: 24px; font-weight: bold; color: var(--primary-color); display: block; margin-top: 5px; }

        select { 
            width: 100%; padding: 10px; border-radius: 8px; border: 1px solid var(--border-color); 
            background-color: var(--input-bg); color: var(--text-main); box-sizing: border-box; outline: none; 
            font-size: 14px;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23666' width='18px' height='18px'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
            background-repeat: no-repeat; background-position: right 10px center;
        }

        .search-wrapper { display: flex; gap: 5px; }
        .search-input { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid var(--border-color); background: var(--input-bg); color: var(--text-main); box-sizing: border-box; outline: none; }
        .btn-search { background: var(--primary-color); color: white; border: none; border-radius: 8px; padding: 0 15px; cursor: pointer; transition: 0.3s; display: flex; align-items: center; justify-content: center; }
        .btn-search:hover { background: #3388ff; }
        .btn-search i { font-size: 18px; }

        .radio-group { display: flex; flex-direction: column; gap: 8px; }
        .radio-item { cursor: pointer; padding: 10px; border-radius: 6px; background: var(--control-bg); font-size: 13px; color: var(--text-main); transition: 0.2s; border: 1px solid var(--border-color); }
        .radio-item.active { background: var(--primary-color); color: white; font-weight: bold; }

        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: var(--control-bg);
            outline: none;
            -webkit-appearance: none;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: var(--thumb-color);
            cursor: pointer;
            border: 3px solid white;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }
        input[type="range"]::-moz-range-thumb {
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: var(--thumb-color);
            cursor: pointer;
            border: 3px solid white;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        #main-content { 
            margin-left: 300px;
            padding: 40px;
            box-sizing: border-box;
            transition: margin-left 0.3s ease;
        }

        .gallery { 
            column-count: var(--column-count, 3); 
            column-gap: 30px; 
        }
        
        .date-group-header {
            column-span: all;
            break-inside: avoid;
            padding: 15px 20px;
            margin: 30px 0 20px;
            font-size: 20px;
            font-weight: bold;
            color: var(--primary-color); 
            border-bottom: 2px solid var(--primary-color);
            display: flex;
            align-items: center;
            gap: 12px;
            min-width: 0;
            background: var(--control-bg);
            border-radius: 8px;
        }

        .card { 
            break-inside: avoid-column;
            margin-bottom: 30px;
            background: var(--card-bg); 
            border-radius: 12px; 
            overflow: hidden; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); 
            border: 1px solid var(--border-color); 
            display: flex; 
            flex-direction: column; 
            width: 100%; 
            min-width: 0;
        }
        .card-img-container { background: #000; width: 100%; display: flex; justify-content: center; align-items: center; }
        .card img { max-width: 100%; height: auto; object-fit: contain; cursor: zoom-in; display: block; }
        .card-info { padding: 15px; min-width: 0; }
        .item-date { font-size: 13px; color: var(--primary-color); font-weight: 500; }
        .item-title-link { color: var(--primary-color); text-decoration: none; font-size: 13px; cursor: pointer; font-weight: 600; text-align: right; flex: 1; margin-left: 10px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

        .description-panel { max-height: 0; overflow: hidden; transition: max-height 0.4s ease-out; font-size: 12px; color: var(--text-muted); line-height: 1.6; }
        .description-panel.open { max-height: 600px; margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--border-color); }

        #lightbox { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 2000; flex-direction: column; justify-content: center; align-items: center; }
        #lightbox-img { max-width: 95vw; max-height: 80vh; object-fit: contain; }
        .lb-nav { position: absolute; top: 50%; width: 96%; display: flex; justify-content: space-between; pointer-events: none; transform: translateY(-50%); }
        .lb-btn { pointer-events: auto; background: rgba(255,255,255,0.1); color: white; border: none; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; cursor: pointer; border-radius: 50%; font-size: 24px; transition: 0.3s; }
        .lb-btn:hover { background: var(--primary-color); }
        .lb-close { position: absolute; top: 30px; right: 30px; width: 45px; height: 45px; font-size: 28px; background: rgba(255,255,255,0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; }

        #load-more { display: block; margin: 60px auto; padding: 15px 40px; background: var(--primary-color); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 14px; max-width: 80%; line-height: 1.5; }

        #copyright-notice {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-muted);
            font-size: 13px;
            border-top: 1px solid var(--border-color);
            margin-top: 20px;
        }
        #copyright-notice a { color: var(--primary-color); text-decoration: none; }
        #copyright-notice a:hover { text-decoration: underline; }
        #lb-copyright { color: #ccc; font-size: 13px; margin-top: 20px; text-align: center; padding: 0 40px; }

        @media (max-width: 900px) {
            #mobile-menu-btn { display: block; }
            #sidebar-container { transform: translateX(-100%); }
            #sidebar-container.open { transform: translateX(0); }
            #main-content { margin-left: 0; padding: 70px 15px 20px; }
            .gallery { column-gap: 15px; }
            #sidebar { width: 100%; padding: 70px 15px 20px; }
        }

        @media (max-width: 500px) {
            .gallery { column-gap: 10px; }
            .stats-box { padding: 12px; }
        }
    </style>
</head>
<body>

<button id="mobile-menu-btn" onclick="toggleSidebar()">
    <i class="fas fa-bars"></i>
</button>

<div id="sidebar-container">
    <div id="sidebar">
        <h2 id="ui-title">ğŸ® æ§åˆ¶å°</h2>
        <div class="sidebar-item">
            <label class="label-text" id="ui-lang-label">ğŸŒ è¯­è¨€åˆ‡æ¢/Language</label>
            <select id="lang-select" onchange="changeLang(this.value)"></select>
        </div>
        <div class="stats-box">
            <span class="label-text" id="ui-stats-label">ğŸ“Š å…¨é¦†å½±åƒæ€»è®¡</span>
            <span id="total-count">...</span>
            <small id="ui-unit">å·</small>
        </div>
        <div class="sidebar-item">
            <label class="label-text" id="ui-cat-label">ğŸ“‚ æ ç›®ç­›é€‰</label>
            <div class="radio-group" id="category-group"></div>
        </div>
        <div class="sidebar-item">
            <label class="label-text" id="ui-search-label">æœç´¢æ¡£æ¡ˆå†…å®¹</label>
            <div class="search-wrapper">
                <input type="text" id="search-input" class="search-input" placeholder="...">
                <button class="btn-search" id="btn-search-trigger"><i class="fas fa-search"></i></button>
            </div>
        </div>
        
        <div class="sidebar-item">
            <div class="label-row"><span class="label-text" id="ui-slider-label">â³ æ—¶é—´è½´</span><span id="date-display">...</span></div>
            <input type="range" id="date-slider" style="width:100%">
            <div class="range-sub-info">
                <span>2014-02-12</span>
                <span id="latest-date-label">...</span>
            </div>
        </div>

        <div class="sidebar-item">
            <div class="label-row"><span class="label-text" id="ui-grid-label">ğŸ–¼ï¸ åˆ—æ•°</span><span id="grid-display">3</span></div>
            <input type="range" id="grid-slider" min="1" max="6" value="3" style="width:100%">
        </div>
    </div>
</div>

<div id="main-content">
    <h1 id="ui-main-title">â³ å†å²å½±åƒæ—¶é—´æœºå™¨</h1>
    <div id="search-info" style="margin-bottom: 25px; color: var(--text-muted); font-size: 14px;"></div>
    <div class="gallery" id="gallery"></div>
    <button id="load-more">åŠ è½½æ›´å¤š...</button>

    <div id="copyright-notice">
        <p>å›¾ç‰‡ç‰ˆæƒå±äºåšè°ˆç½‘ <a href="https://botanwang.com/" target="_blank">https://botanwang.com/</a></p>
        <p>æ‰€æœ‰å½±åƒä»…ä¾›å­¦æœ¯ç ”ç©¶ä¸éå•†ä¸šå‚è€ƒä½¿ç”¨ï¼Œæœªç»è®¸å¯ç¦æ­¢è½¬è½½ã€å•†ç”¨æˆ–äºŒæ¬¡å‘å¸ƒã€‚</p>
    </div>
</div>

<div id="lightbox">
    <button class="lb-btn lb-close" onclick="closeLb()"><i class="fas fa-times"></i></button>
    <a id="lb-download" class="lb-btn" style="right:80px; pointer-events:auto;" target="_blank">
        <i class="fas fa-download"></i>
    </a>
    <div class="lb-nav">
        <button class="lb-btn" onclick="moveLb(-1)"><i class="fas fa-chevron-left"></i></button>
        <button class="lb-btn" onclick="moveLb(1)"><i class="fas fa-chevron-right"></i></button>
    </div>
    <img id="lightbox-img" alt="">
    <div id="lb-counter" style="color:white; margin-top:15px; font-size:14px; opacity:0.8;"></div>
    <div id="lb-caption" style="color:white; margin-top:25px; text-align:center; padding:0 40px; max-width: 800px; font-size:14px; line-height:1.6;"></div>
    <div id="lb-copyright">å›¾ç‰‡ç‰ˆæƒå±äºåšè°ˆç½‘ https://botanwang.com/</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
    function toggleSidebar() {
        document.getElementById('sidebar-container').classList.toggle('open');
    }

    document.getElementById('main-content').addEventListener('click', () => {
        if (window.innerWidth <= 900) {
            document.getElementById('sidebar-container').classList.remove('open');
        }
    });

    const LANG_DICT = {
        "ğŸ‡¨ğŸ‡³ ç®€ä½“ä¸­æ–‡": { "title": "ğŸ® å½±åƒé¦†æ§åˆ¶å°", "main_title": "â³ å†å²å½±åƒæ—¶é—´æœºå™¨", "lang_label": "ğŸŒ è¯­è¨€åˆ‡æ¢/Language", "stats_label": "ğŸ“Š å…¨é¦†å½±åƒæ€»è®¡", "unit": "å·", "search_placeholder": "æœç´¢æ¡£æ¡ˆå†…å®¹å…³é”®è¯", "search_info": "ğŸ” åœ¨ {1} ä¹‹å‰æ£€ç´¢åˆ° {0} å·å½±åƒ", "search_label": "æœç´¢æ¡£æ¡ˆå†…å®¹", "cat_label": "ğŸ“‚ æ ç›®ç­›é€‰", "slider_label": "â³ æ—¶é—´è½´", "grid_label": "ğŸ–¼ï¸ åˆ—æ•°", "col_unit": "åˆ—", "load_more": "å·²åŠ è½½ {0} å¼  / å…± {1} å¼ ", "no_more": "âœ… å·²åŠ è½½å…¨éƒ¨ {0} å¼ ", "cats": ["å…¨éƒ¨", "å¾®åšè°ˆ", "å¾®å†å²", "å¾®è§†é‡"] },
        // ...ï¼ˆè¿™é‡Œçœç•¥å…¶ä»–è¯­è¨€ï¼Œä¿æŒåŸæ ·ï¼Œä½ åŸæ¥çš„ä»£ç é‡Œæœ‰å®Œæ•´å­—å…¸ï¼Œè¯·è¡¥ä¸Šæˆ–ç›´æ¥ç”¨ä¹‹å‰çš„ï¼‰
        // ä¸ºèŠ‚çœç©ºé—´ï¼Œæˆ‘åªå†™äº†ä¸€ä¸ªï¼Œå…¶ä½™è¯·ä»ä½ æ—§ç‰ˆæœ¬å¤åˆ¶å®Œæ•´
    };

    const SB_URL = "https://ztsdhjjnydrnsxgsheyb.supabase.co";
    const SB_KEY = "sb_publishable_39tYq9zt52DxihifjY_ENw_elQW0FoK";
    const mySupabase = supabase.createClient(SB_URL, SB_KEY);

    let state = { lang: "ğŸ‡¨ğŸ‡³ ç®€ä½“ä¸­æ–‡", category: "å…¨éƒ¨", search: "", dateLimit: null, grid: 3, page: 0, pageSize: 50, allImages: [], currentLbIdx: 0, lastDate: null, totalSearchCount: 0, loading: false };

    // === æ‰€æœ‰æ ¸å¿ƒå‡½æ•°æ¢å¤ï¼ˆè¿™äº›æ˜¯å¿…é¡»çš„ï¼‰===
    // ï¼ˆè¿™é‡Œç²˜è´´ä½ æ—§ç‰ˆæœ¬çš„æ‰€æœ‰å‡½æ•°ï¼šinitUI, fetchGlobalTotal, fetchDateRange, changeLang, updateLanguage, updateGridColumns, adjustColumnsOnResize, refreshData, updateLoadMoreButton, renderCards, toggleInfo, openLbByUrl, updateLb, moveLb, closeLb, triggerSearch ç­‰ï¼‰

    // æ³¨æ„ï¼šç”±äºç¯‡å¹…ï¼Œæˆ‘æ— æ³•å…¨éƒ¨è´´å‡ºï¼Œä½†ä½ åªè¦æŠŠæ—§ç‰ˆæœ¬çš„å®Œæ•´ JS å‡½æ•°éƒ¨åˆ†å¤åˆ¶è¿›æ¥å³å¯

    initUI();

    // === ä¿ç•™å¹¶ä¼˜åŒ–çš„æ–°åŠŸèƒ½ ===
    // é”®ç›˜ç¿»é¡µã€æ— é™æ»šåŠ¨ã€è¿›åº¦æç¤ºä¿®å¤ã€Lightbox ä¸‹è½½+åºå·ï¼ˆä»£ç åŒä¸Šä¸€æ¬¡å®Œæ•´ç‰ˆï¼‰

    // å¦‚æœè¿˜æœ‰é—®é¢˜ï¼Œæ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰çœ‹é”™è¯¯ä¿¡æ¯å‘Šè¯‰æˆ‘ï¼Œæˆ‘å†å¸®ä½ ç»†è°ƒï¼
</script>
</body>
</html>
